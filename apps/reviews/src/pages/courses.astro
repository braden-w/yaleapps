---
import { db } from '@repo/db/courses'
import Layout from '../layouts/Layout.astro'
import { CoursesDataTable } from './_courses/CoursesDataTable'

const allCourses = await db.query.courses.findMany({
	limit: 10,
	where: (courses, { eq }) => eq(courses.season_code, '202403'),
	orderBy: (courses, { desc }) => [desc(courses.average_comment_compound)],
	with: {
		listings: true,
	},
})
---

<Layout>
	<CoursesDataTable courses={allCourses} client:load />
</Layout>
../_/CoursesDataTable