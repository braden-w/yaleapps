---
import { courses, db } from '@repo/db/courses';
import { buttonVariants } from '@repo/ui/components/button';
import { PageActions, PageHeader, PageHeaderHeading } from '@repo/ui/components/page-header';
import { Spotlight } from '@repo/ui/components/spotlight';
import { cn } from '@repo/ui/lib/utils';
import GithubIcon from '~icons/mdi/github';
import Layout from '../layouts/Layout.astro';
import { SITE_CONFIG } from '../site.config';

async function getAllSeasonCodes() {
	const queryResult = await db.selectDistinct({ season_code: courses.season_code }).from(courses);
	const seasonCodes = queryResult.map((result) => result.season_code).sort();
	return seasonCodes;
}

const allSeasonCodes = await getAllSeasonCodes();
---

<Layout>
	<PageHeader>
		<Spotlight className="-top-40 left-0 md:-top-20 md:left-60" fill="#00356b" />
		<PageHeaderHeading>List course by sentiment descending</PageHeaderHeading>
		<PageActions>
			<a href="/202403" class={cn(buttonVariants())}>Open Fall 2024</a>
			<a
				target="_blank"
				rel="noreferrer"
				href={SITE_CONFIG.githubUrl}
				class={cn(buttonVariants({ variant: 'outline' }))}
			>
				<GithubIcon transition:name="github" class="mr-2 h-4 w-4" />
				Open GitHub
			</a>
		</PageActions>
	</PageHeader>
</Layout>
